create or replace PROCEDURE SA_CLAIM_PAYOUT_APPROVE
()
AS
set serveroutput  on 
declare
da licaccounting.sa_inpdata;

cursor c1 is select licaccounting.sa_inp_obj(
ACCOUNTRULECONTEXT,
REF_NO,
EFFECTIVE_DATE_OF_PAYMENT     ,
PAYOUT_SOURCE_MODULE          ,
BENEFICIARY_PAYMENT_ID        ,
PRODUCT_CODE                  ,
VARIANT_CODE                  ,
PAYMENT_AMOUNT                ,
OPERATING_UNIT                ,
OPERATING_UNIT_TYPE           ,
PAYMENT_MODE                  ,
POLICY_NUMBER                 ,
LINE_OF_BUSINESS              ,
PRODUCT                       ,
MPH_CODE                      ,
PRODUCT_VARIANT               ,
I_CODE_FOR_LOB                ,
I_CODE_FOR_PRODUCT_LINE       ,
I_CODE_FOR_VARIANT            ,
I_CODE_FOR_BUSINESS_TYPE      ,
I_CODE_FOR_PARTICIPATING_TYPE ,
I_CODE_FOR_BUSINESS_SEGMENT   ,
I_CODE_FOR_INVESTMENT_PORTFOLIO,
BENEFICIARY_NAME              ,
BENEFICIARY_BANK_NAME         ,
BENEFICIARY_BRANCH_IFSC       ,
BENEFICIARY_BRANCH_NAME       ,
BENEFICIARY_ACCOUNT_TYPE      ,
BENEFICIARY_ACCOUNT_NUMBER    ,
BENEFICIARY_LEI               ,
SENDER_LEI                    ,
UNIT_CODE                     ,
MEMBER_NUMBER                 ,
PAYMENT_CATEGORY              ,
PAYMENT_SUB_CATEGORY          ,
NRO_ACCOUNT                   ,
IBAN                          ,
REMARKS           ,            ISTDSAPPLICABLE, PANNUMBER, PAYMENTAMOUNT, PAYMENTDUEDATE, TDSAMOUNT, TDSREMARKS, FINANCIALYEAR, MONTH, CUSTCODE, DOMAINBATCHNO, TDSPCT,intafundAmountDebit,
GSTexpenseAmount ,
rocannuityAmount ,
gstliabiltyAmount,isGSTPaidByLIC,ISGSTAPPLICABLE, TRANSACTIONTYPE, TRANSACTION_SUB_TYPE, GSTREFNO, GST_REF_TRANSACTION_NO, GST_TRANSACTION_TYPE, AMOUNT_WITH_TAX
, AMOUNT_WITHOUT_TAX, CESS_AMOUNT, TOTAL_GST_AMOUNT, GST_RATE, CGST_AMOUNT, CGST_RATE, IGST_AMOUNT, IGST_RATE, SGST_AMOUNT, SGST_RATE, UTGST_AMOUNT, UTGST_RATE, 
GST_APPLICABLE_TYPE, GST_TYPE, COLLECTION_ID, TO_GSTIN, FROM_GSTN, HSN_CODE, FROM_PAN, TO_PAN, NATURE_OF_TRANSACTION, MPH_NAME, MPH_ADDRESS, ENTRY_TYPE, GSTREMARKS,
OLD_INVOICE_DATE,from_state_code,to_state_code ,created_by ,MVA_CHARGE,EXIT_CHARGE)
from (select 'Withdrawal Claim Payment Approval SA' ACCOUNTRULECONTEXT,'416551' ref_no,to_date('2023-01-27','yyyy-MM-dd') EFFECTIVE_DATE_OF_PAYMENT,'Test2' PAYOUT_SOURCE_MODULE,'1266704' BENEFICIARY_PAYMENT_ID,'TEST@' PRODUCT_CODE,'TEST@' VARIANT_CODE,'2000' PAYMENT_AMOUNT,'G901' OPERATING_UNIT,'UO' OPERATING_UNIT_TYPE,'N' PAYMENT_MODE,'SL99887501' POLICY_NUMBER,'9' LINE_OF_BUSINESS,'PROCE' PRODUCT,'G8978' MPH_CODE,'G9878U' PRODUCT_VARIANT,'9' I_CODE_FOR_LOB,'9' I_CODE_FOR_PRODUCT_LINE,'9' I_CODE_FOR_VARIANT,'9' I_CODE_FOR_BUSINESS_TYPE,'9' I_CODE_FOR_PARTICIPATING_TYPE
,'9' I_CODE_FOR_BUSINESS_SEGMENT,'9' I_CODE_FOR_INVESTMENT_PORTFOLIO,'Sruthi' BENEFICIARY_NAME,'HDFC' BENEFICIARY_BANK_NAME,'HDFC00786' BENEFICIARY_BRANCH_IFSC,'MUM' BENEFICIARY_BRANCH_NAME,'AC4' BENEFICIARY_ACCOUNT_TYPE,'9076456899'  BENEFICIARY_ACCOUNT_NUMBER,'78CHERE' BENEFICIARY_LEI,'MEASSED87' SENDER_LEI,'G901' UNIT_CODE,'YOUASME' MEMBER_NUMBER,'NEFT' PAYMENT_CATEGORY,'SB' PAYMENT_SUB_CATEGORY,'YESTCH' NRO_ACCOUNT,'CHECK' IBAN,'CHEC' REMARKS,'YES' isTDSapplicable,'SBNCJ12045' panNumber,1000 paymentAmount,to_date(to_char(SYSDATE,'DD-MON-RR'),'DD-MON-RR') paymentDueDate,1000 tdsAmount
,'nocomment' tdsremarks,'2022' financialYear,'JAN' month,'10335' custCode,'asds12345' DOMAINBATCHNO,'1234' TDSPCT, 1 intafundAmountDebit ,
5 GSTexpenseAmount ,
4 rocannuityAmount ,
3 gstliabiltyAmount,'YES' isGSTPaidByLIC,
'YES' isGSTapplicable ,
'A' transactionType ,
'A' TRANSACTION_SUB_TYPE ,
NULL gstRefNo ,
NULL GST_REF_TRANSACTION_NO ,
NULL GST_TRANSACTION_TYPE ,
100 AMOUNT_WITH_TAX ,
120 AMOUNT_WITHOUT_TAX ,
10 CESS_AMOUNT ,
NULL TOTAL_GST_AMOUNT ,
NULL GST_RATE ,
NULL CGST_AMOUNT ,
NULL CGST_RATE ,
NULL IGST_AMOUNT ,
NULL IGST_RATE ,
NULL SGST_AMOUNT ,
NULL SGST_RATE ,
NULL UTGST_AMOUNT ,
NULL UTGST_RATE ,
NULL GST_APPLICABLE_TYPE ,
NULL GST_TYPE ,
NULL COLLECTION_ID ,
NULL TO_GSTIN ,
NULL FROM_GSTN ,
NULL HSN_CODE ,
NULL FROM_PAN ,
NULL TO_PAN ,
NULL NATURE_OF_TRANSACTION ,
NULL MPH_NAME ,
NULL MPH_ADDRESS ,
NULL ENTRY_TYPE ,
NULL gstREMARKS ,
NULL OLD_INVOICE_DATE,
null from_state_code,
null to_state_code,
user created_by,
20 MVA_CHARGE,
30 EXIT_CHARGE
from dual connect by level<=1);
P_OUT_JOURNAL_NO NUMBER;
 P_OUT_DEBITACCOUNT NUMBER;
 P_OUT_PAYMENTCREDITACCOUNT NUMBER;
 P_OUT_TDSCREDITACCOUNT NUMBER;
 P_OUT_TOTALAMOUNT NUMBER;
 P_OUT_PAYMENTAMOUNT NUMBER;
 P_OUT_TdsAMOUNT NUMBER;
 P_OUT_CREDITICODE VARCHAR2(100);
 P_OUT_DEBITICODE VARCHAR2(100);
 P_OUT_MESSAGE VARCHAR2(100);
 P_OUT_STATUS VARCHAR2(100);
 P_OUT_STATUSCODE VARCHAR2(100);
 P_SQLCODE NUMBER;
 P_SQLERROR_MESSAGE VARCHAR2(1000);
begin
open c1;
fetch c1 bulk collect  into da;
close c1;
dbms_output.put_line('count '||da.count);
LICACCOUNTING.SA_CLAIM_PAYOUT_APPROVE(da,P_OUT_JOURNAL_NO,P_OUT_DEBITACCOUNT,P_OUT_TDSCREDITACCOUNT,P_OUT_PAYMENTCREDITACCOUNT,P_OUT_TOTALAMOUNT,P_OUT_PAYMENTAMOUNT,P_OUT_tdsAMOUNT,P_OUT_CREDITICODE,P_OUT_DEBITICODE,P_OUT_MESSAGE,P_OUT_STATUS,P_OUT_STATUSCODE,P_SQLCODE,P_SQLERROR_MESSAGE);
dbms_output.put_line('P_OUT_DEBITACCOUNT '||P_OUT_DEBITACCOUNT);
dbms_output.put_line('P_OUT_TDSCREDITACCOUNT '||P_OUT_TDSCREDITACCOUNT);
dbms_output.put_line('P_OUT_PAYMENTCREDITACCOUNT '||P_OUT_PAYMENTCREDITACCOUNT);
dbms_output.put_line('P_OUT_PAYMENTAMOUNT '||P_OUT_PAYMENTAMOUNT);
dbms_output.put_line('P_OUT_tdsAMOUNT '||P_OUT_tdsAMOUNT);
--dbms_output.put_line('P_OUT_CREDITACCOUNT '||P_OUT_CREDITACCOUNT);
dbms_output.put_line('P_OUT_CREDITICODE '||P_OUT_CREDITICODE);
dbms_output.put_line('P_OUT_MESSAGE '||P_OUT_MESSAGE);
dbms_output.put_line('P_OUT_STATUSCODE '||P_OUT_STATUSCODE);
dbms_output.put_line('P_SQLCODE '||P_SQLCODE);
dbms_output.put_line('P_SQLERROR_MESSAGE '||P_SQLERROR_MESSAGE);

end;

END SA_CLAIM_PAYOUT_APPROVE;